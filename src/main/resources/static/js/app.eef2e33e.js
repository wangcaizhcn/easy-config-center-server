(function(){var e={1384:function(e,t,i){"use strict";var n=i(144),s=i(4720),a=i.n(s),l=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},o=[],r=i(3736),c={},g=(0,r.Z)(c,l,o,!1,null,null,null),d=g.exports,p=i(8345),h=function(){var e=this,t=e._self._c;return t("div",{staticClass:"conTop"},[t("div",{staticClass:"login_form"},[t("div",{staticClass:"welcome"},[e._v("欢迎使用")]),t("div",{staticClass:"system_name"},[e._v("统一配置中心")]),t("div",{staticStyle:{"margin-top":"30px"}},[t("el-form",[t("el-form-item",[t("div",[t("el-input",{attrs:{"prefix-icon":"el-icon-user",placeholder:"请输入用户名",clearable:!0},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1)]),t("el-form-item",[t("div",[t("el-input",{attrs:{"prefix-icon":"el-icon-lock",placeholder:"请输入密码",clearable:!0,"show-password":""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.doLogin.apply(null,arguments)}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1)]),t("el-form-item",[t("el-button",{staticClass:"login_button",attrs:{type:"primary"},on:{click:e.doLogin}},[e._v("登录")])],1)],1)],1)])])},u=[],f=i(5121),m=i(629);n["default"].use(m.ZP);var v=new m.ZP.Store({state:{},getters:{},mutations:{},actions:{logout(e){return new Promise(((e,t)=>{setTimeout((()=>{K(),F.push("/Login"),e({code:"0",data:"success"})}),500)}))}},modules:{}});const y=window.localStorage,x=(e,t)=>{t=void 0!==t&&null!==t?t:"","object"===typeof t&&(t=JSON.stringify(t)),y.setItem("app_"+e,t)},b=e=>{const t=y.getItem("app_"+e);let i="";try{i=JSON.parse(t)}catch(n){i=t}return i},S=f.Z.create({timeout:3e4});S.beforeRequest=[],S.nextResponse=[],S.addBeforRequest=e=>{S.beforeRequest.includes(e)||S.beforeRequest.push(e)},S.removeBeforRequest=e=>{S.beforeRequest.includes(e)&&S.beforeRequest.findIndex(((t,i)=>{t===e&&S.beforeRequest.splice(i,1)}))},S.addNextResponse=e=>{S.nextResponse.includes(e)||S.nextResponse.push(e)},S.removeNextResponse=e=>{S.nextResponse.includes(e)&&S.nextResponse.findIndex(((t,i)=>{t===e&&S.nextResponse.splice(i,1)}))},S.interceptors.request.use((e=>{const t=b("token");return t&&(e.headers["Authorization"]=t),e})),S.interceptors.response.use((e=>{if(200===e.status){if("0"===e.data.code){let t=e.data;console.log("=========>"+e.config.url);const i=["login/refresh","login"];return i.includes(e.config.url)&&(t.headers=e.headers),t.headers=e.headers,t}if("blob"===e.config.responseType)return e;e.config.url.includes("login/refresh")?s.Message.error("您的登录状态已失效，请重新登录！"):s.Message.error(e.data.message)}return Promise.reject(e)}),(e=>e.response?"login/refresh"===e.response.config.url?Promise.reject(e):401===e.response.status?T(b("refreshToken")).then((t=>(x("token",t.headers.authorization),x("refreshToken",t.headers["authorization-refresh"]),S(e.response.config)))).catch((e=>(console.log("抱歉，您的登录状态已失效，请重新登录！"),F.push("/Login"),Promise.reject(e)))):Promise.reject(e):Promise.reject(e)));var w=S;const k=()=>w({url:"login/key"}),_=e=>w({url:"login/",data:e,method:"post"}),T=e=>w({url:"login/refresh",data:{},headers:{"Authorization-Refresh":e},method:"post"});var V=i(1354),L=i.n(V),I={name:"Login",data(){return{username:"",password:"",keys:{}}},methods:{async getEncodeKey(){await k().then((e=>{this.keys=e.data}))},async doLogin(){await this.getEncodeKey();let e=this.encryptByDES(this.password,this.keys.encode_key),t={username:this.username,password:e,key:this.keys.key};await this.login(t)},async login(e){await _(e).then((e=>{x("token",e.headers.authorization),x("refreshToken",e.headers["authorization-refresh"])})),F.push("/configManager")},encryptByDES(e,t){if(""==e)return"";let i=L().enc.Utf8.parse(t),n=L().DES.encrypt(e,i,{mode:L().mode.ECB,padding:L().pad.Pkcs7});return n.toString()}}},C=I,$=(0,r.Z)(C,h,u,!1,null,"406ac072",null),z=$.exports,N=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{height:"calc(100vh - 10px)","padding-top":"10px"}},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.fullscreenLoading,expression:"fullscreenLoading"}],staticClass:"main"},[t("div",{staticClass:"title"},[e._v("配置项管理")]),t("el-divider"),t("div",{staticStyle:{display:"flex","align-items":"center",margin:"10px"}},[t("div",{staticStyle:{"margin-right":"5px","font-size":"14px"}},[e._v("版本：")]),t("el-select",{staticStyle:{"margin-right":"30px"},attrs:{size:"small",placeholder:"请选择"},on:{change:e.changeVersion},model:{value:e.selectVersion,callback:function(t){e.selectVersion=t},expression:"selectVersion"}},e._l(e.versionList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),t("div",{staticStyle:{"margin-right":"5px","font-size":"14px"}},[e._v("标签：")]),t("el-select",{staticStyle:{"margin-right":"30px"},attrs:{size:"small",placeholder:"请选择"},on:{change:e.changeTag},model:{value:e.selectTag,callback:function(t){e.selectTag=t},expression:"selectTag"}},e._l(e.tagList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.cloneDialogVisible=!0}}},[e._v("克隆")])],1),t("div",{staticStyle:{"margin-left":"10px","margin-right":"10px"}},[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.add}},[e._v("添加配置项")])],1),t("div",{staticStyle:{"margin-left":"10px","margin-right":"10px","margin-top":"5px"}},[t("el-table",{staticStyle:{width:"100%"},attrs:{size:"small",border:"",data:e.configList,height:e.tableHeight,"header-cell-style":{background:"#E9E9E9",color:"#434343"},"cell-style":{padding:"3px"}}},[t("el-table-column",{attrs:{label:"序号",type:"index",width:"50"}}),t("el-table-column",{attrs:{prop:"key",label:"配置项",width:"250"}}),t("el-table-column",{attrs:{prop:"value",label:"配置值",width:"250"}}),t("el-table-column",{attrs:{prop:"description",label:"描述"}}),t("el-table-column",{attrs:{width:"80",label:"是否有效"},scopedSlots:e._u([{key:"default",fn:function(i){return[i.row.activity?t("div",{staticStyle:{color:"green"}},[e._v("有效")]):t("div",{staticStyle:{color:"red"}},[e._v("失效")])]}}])}),t("el-table-column",{attrs:{label:"操作",width:"110",align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.update(i.row,i.$index)}}},[e._v("修改")]),t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.deleteConfig(i.row,i.$index)}}},[e._v("删除")])]}}])})],1)],1),t("el-dialog",{attrs:{title:"克隆",visible:e.cloneDialogVisible,width:"600px"},on:{"update:visible":function(t){e.cloneDialogVisible=t}}},[t("div",{staticStyle:{"margin-top":"-10px"}},[t("div",{staticStyle:{"padding-left":"30px"}},[t("el-radio",{attrs:{label:"cloneTag"},model:{value:e.cloneType,callback:function(t){e.cloneType=t},expression:"cloneType"}},[e._v("克隆标签")]),t("el-radio",{attrs:{label:"cloneVersion"},model:{value:e.cloneType,callback:function(t){e.cloneType=t},expression:"cloneType"}},[e._v("克隆版本")])],1),t("div",{staticClass:"note",staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},["cloneTag"===e.cloneType?t("div",[e._v("提示： 克隆标签，会根据原始版本、原始标签创建出新的标签，新的标签仍然隶属于原始版本，同时新标签下包含原始标签下全部的配置项信息。")]):e._e(),"cloneVersion"===e.cloneType?t("div",[e._v("提示： 克隆版本，会根据原始版本创建出新的版本，新的版本包含原始版本下全部的标签及标签下全部的配置项信息。")]):e._e()]),t("div",{staticStyle:{display:"flex","align-items":"center","margin-top":"30px","line-height":"32px"}},[t("span",{staticStyle:{width:"130px","padding-right":"10px","text-align":"right"}},[e._v("原始版本：")]),t("div",{staticStyle:{width:"400px"}},[e._v(e._s(e.selectVersion))])]),"cloneTag"===e.cloneType?t("div",{staticStyle:{display:"flex","align-items":"center","line-height":"32px"}},[t("span",{staticStyle:{width:"130px","padding-right":"10px","text-align":"right"}},[e._v("原始标签：")]),t("div",{staticStyle:{width:"400px"}},[e._v(e._s(e.selectTag))])]):e._e(),"cloneVersion"===e.cloneType?t("div",{staticStyle:{display:"flex","align-items":"center","margin-bottom":"10px","margin-top":"10px"}},[t("span",{staticStyle:{width:"130px","padding-right":"10px","text-align":"right"}},[t("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v("克隆后版本名称：")]),t("div",{staticStyle:{width:"400px"}},[t("el-input",{staticStyle:{width:"350px"},attrs:{size:"small",placeholder:"请输入版本名称",clearable:""},model:{value:e.cloneVersionName,callback:function(t){e.cloneVersionName=t},expression:"cloneVersionName"}})],1)]):e._e(),"cloneTag"===e.cloneType?t("div",{staticStyle:{display:"flex","align-items":"center","margin-bottom":"10px","margin-top":"10px"}},[t("span",{staticStyle:{width:"130px","padding-right":"10px","text-align":"right"}},[t("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v("克隆后标签名称：")]),t("div",{staticStyle:{width:"400px"}},[t("el-input",{staticStyle:{width:"350px"},attrs:{size:"small",placeholder:"请输入标签名称",clearable:""},model:{value:e.cloneTagName,callback:function(t){e.cloneTagName=t},expression:"cloneTagName"}})],1)]):e._e()]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.cloneDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.clone}},[e._v("确 定")])],1)]),t("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible,width:"600px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("div",{staticStyle:{"margin-top":"-10px"}},[t("div",{staticStyle:{display:"flex","align-items":"center","margin-bottom":"10px","line-height":"32px"}},[t("span",{staticStyle:{width:"130px","padding-right":"10px","text-align":"right"}},[e._v("所属版本：")]),t("div",{staticStyle:{width:"400px"}},[e._v(e._s(e.selectVersion))])]),t("div",{staticStyle:{display:"flex","align-items":"center","margin-bottom":"10px","line-height":"32px"}},[t("span",{staticStyle:{width:"130px","padding-right":"10px","text-align":"right"}},[e._v("所属标签：")]),t("div",{staticStyle:{width:"400px"}},[e._v(e._s(e.selectTag))])]),t("div",{staticStyle:{display:"flex","align-items":"center","margin-bottom":"10px"}},[t("span",{staticStyle:{width:"130px","padding-right":"10px","text-align":"right"}},[t("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v("配置项：")]),t("div",{staticStyle:{width:"400px"}},[t("el-input",{staticStyle:{width:"350px"},attrs:{size:"small",placeholder:"请输入版本名称",clearable:""},model:{value:e.configItem.key,callback:function(t){e.$set(e.configItem,"key",t)},expression:"configItem.key"}})],1)]),t("div",{staticStyle:{display:"flex","align-items":"center","margin-bottom":"10px"}},[t("span",{staticStyle:{width:"130px","padding-right":"10px","text-align":"right"}},[t("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v("配置值：")]),t("div",{staticStyle:{width:"400px"}},[t("el-input",{staticStyle:{width:"350px"},attrs:{size:"small",placeholder:"请输入标签名称",clearable:""},model:{value:e.configItem.value,callback:function(t){e.$set(e.configItem,"value",t)},expression:"configItem.value"}})],1)]),t("div",{staticStyle:{display:"flex","align-items":"center","margin-bottom":"10px","line-height":"32px"}},[t("span",{staticStyle:{width:"130px","padding-right":"10px","text-align":"right"}},[t("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v("是否有效：")]),t("div",{staticStyle:{width:"400px"}},[t("el-checkbox",{model:{value:e.configItem.activity,callback:function(t){e.$set(e.configItem,"activity",t)},expression:"configItem.activity"}})],1)]),t("div",{staticStyle:{display:"flex","align-items":"center","margin-bottom":"10px"}},[t("span",{staticStyle:{width:"130px","padding-right":"10px","text-align":"right"}},[e._v("描述：")]),t("div",{staticStyle:{width:"400px"}},[t("el-input",{staticStyle:{width:"350px"},attrs:{type:"textarea",rows:3,size:"small",placeholder:"请输入标签名称",clearable:""},model:{value:e.configItem.description,callback:function(t){e.$set(e.configItem,"description",t)},expression:"configItem.description"}})],1)])]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.doSave}},[e._v("确 定")])],1)])],1)])},O=[];const R=()=>w({url:"management/versions"}),P=e=>w({url:"management/tags?version="+e}),j=(e,t)=>w({url:"management/configs?version="+e+"&tag="+t}),E=e=>w({url:"management/clone-tag",data:e,method:"post"}),M=e=>w({url:"management/clone-version",data:e,method:"post"}),D=e=>w({url:"management/save",data:e,method:"post"});var q={name:"ConfigManager",data(){return{versionList:[],tagList:[],selectVersion:"",selectTag:"",tableHeight:"",configList:[],cloneType:"cloneTag",cloneVersionName:"",cloneTagName:"",cloneDialogVisible:!1,fullscreenLoading:!1,dialogTitle:"",dialogVisible:!1,configItem:{}}},created(){this.tableHeight=window.innerHeight-190+"px",this.init()},methods:{async getVersionList(){await R().then((e=>{let t=[];for(let i=0;i<e.data.length;i++)t.push({value:e.data[i],label:e.data[i]});this.versionList=t})).catch((e=>{})).finally((()=>{}))},getTagList(){this.selectVersion?P(this.selectVersion).then((e=>{let t=[];for(let i=0;i<e.data.length;i++)t.push({value:e.data[i],label:e.data[i]});this.tagList=t,this.tagList.length>0&&(this.selectTag=this.tagList[0].value,this.getConfigList())})):this.tagList=[]},checkVersionAndTag(){return this.selectVersion?!!this.selectTag||(this.$message({message:"请选择克隆的标签",type:"error"}),!1):(this.$message({message:"请选择克隆的版本",type:"error"}),!1)},add(){!1!==this.checkVersionAndTag&&(this.dialogTitle="新增配置项",this.configItem={index:-1,key:"",value:"",description:"",activity:!0},this.dialogVisible=!0)},update(e,t){!1!==this.checkVersionAndTag&&(this.dialogTitle="修改配置项",this.configItem={index:t,key:e.key,value:e.value,description:e.description,activity:e.activity},this.dialogVisible=!0)},doSave(){if(!this.configItem.key)return void this.$message({message:"配置项不能为空",type:"error"});if(this.configItem.key.length>200)return void this.$message({message:"配置项长度过长，长度不能大于200个字符",type:"error"});if(this.configItem.value&&this.configItem.value.length>200)return void this.$message({message:"配置值长度过长，长度不能大于200个字符",type:"error"});if(this.configItem.description&&this.configItem.description.length>500)return void this.$message({message:"描述信息过长，长度不能大于500个字符",type:"error"});-1===this.configItem.index?this.configList.push(this.configItem):this.configList[this.configItem.index]=this.configItem;let e={version:this.selectVersion,tag:this.selectTag,configs:this.configList};D(e).then((e=>{this.$message({message:"保存配置项成功",type:"success"}),this.init()})).catch((e=>{})).finally((()=>{this.dialogVisible=!1}))},deleteConfig(e,t){this.$confirm("是否删除配置项"+e.key,"删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{let e=this.configList.filter(((e,i)=>i!==t)),i={version:this.selectVersion,tag:this.selectTag,configs:e};D(i).then((e=>{this.$message({message:"删除配置项成功",type:"success"}),this.init()})).catch((e=>{})).finally((()=>{this.dialogVisible=!1}))}))},getConfigList(){this.selectVersion&&this.selectTag?j(this.selectVersion,this.selectTag).then((e=>{this.configList=e.data})).catch((e=>{})).finally((()=>{this.fullscreenLoading=!1})):(this.configList=[],this.fullscreenLoading=!1)},clone(){if(!1===this.checkVersionAndTag)return;if("cloneVersion"===this.cloneType){if(!this.cloneVersionName)return void this.$message({message:"克隆后版本名称必填",type:"error"});if(this.cloneVersionName.length>100)return void this.$message({message:"克隆后版本名称过长，长度不能大于100个字符",type:"error"})}else{if(!this.cloneTagName)return void this.$message({message:"克隆后标签名称必填",type:"error"});if(!this.cloneTagName.length>100)return void this.$message({message:"克隆后标签名称过长，长度不能大于100个字符",type:"error"})}let e={version:this.selectVersion,tag:this.selectTag,cloneTag:this.cloneTagName,cloneVersion:this.cloneVersionName},t="cloneVersion"===this.cloneType?M:E;t(e).then((e=>{this.$message({message:"克隆成功",type:"success"}),this.init(),this.cloneDialogVisible=!1})).catch((e=>{}))},init(){this.fullscreenLoading=!0,this.getVersionList().then((()=>{this.versionList.length>0&&(this.selectVersion=this.versionList[0].value,this.getTagList())}))},changeVersion(){this.fullscreenLoading=!0,this.getTagList()},changeTag(){this.fullscreenLoading=!0,this.getConfigList()}}},Z=q,B=(0,r.Z)(Z,N,O,!1,null,"31017676",null),A=B.exports;n["default"].use(p.ZP);const H=[{path:"/login",name:"login",component:z},{path:"/configManager",name:"configManager",component:A}],J=new p.ZP({routes:H});function K(){const e=new p.ZP({routes:H});J.matcher=e.matcher}var F=J;const U=["/login"];F.beforeEach((async(e,t,i)=>{U.includes(e.path)&&i(),0===e.matched.length&&i("/configManager");const n=b("token");if(n){if("/login"!=e.path)return i();i({path:"/configManager"})}else i("/login")})),n["default"].config.productionTip=!1,n["default"].use(a()),a().Dialog.props.closeOnClickModal.default=!1,new n["default"]({router:F,store:v,render:function(e){return e(d)}}).$mount("#app")},2480:function(){}},t={};function i(n){var s=t[n];if(void 0!==s)return s.exports;var a=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(a.exports,a,a.exports,i),a.loaded=!0,a.exports}i.m=e,function(){i.amdO={}}(),function(){var e=[];i.O=function(t,n,s,a){if(!n){var l=1/0;for(g=0;g<e.length;g++){n=e[g][0],s=e[g][1],a=e[g][2];for(var o=!0,r=0;r<n.length;r++)(!1&a||l>=a)&&Object.keys(i.O).every((function(e){return i.O[e](n[r])}))?n.splice(r--,1):(o=!1,a<l&&(l=a));if(o){e.splice(g--,1);var c=s();void 0!==c&&(t=c)}}return t}a=a||0;for(var g=e.length;g>0&&e[g-1][2]>a;g--)e[g]=e[g-1];e[g]=[n,s,a]}}(),function(){i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,{a:t}),t}}(),function(){i.d=function(e,t){for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){i.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={143:0};i.O.j=function(t){return 0===e[t]};var t=function(t,n){var s,a,l=n[0],o=n[1],r=n[2],c=0;if(l.some((function(t){return 0!==e[t]}))){for(s in o)i.o(o,s)&&(i.m[s]=o[s]);if(r)var g=r(i)}for(t&&t(n);c<l.length;c++)a=l[c],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return i.O(g)},n=self["webpackChunklegend"]=self["webpackChunklegend"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=i.O(void 0,[998],(function(){return i(1384)}));n=i.O(n)})();